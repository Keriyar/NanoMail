import { LightColors } from "../themes/colors.slint";

export component IconButton {
    in property <image> icon;
    in property <length> size: 36px;
    in property <length> icon-size: 20px;
    in property <bool> enabled: true;

    callback clicked();

    width: size;
    height: size;

    // macOS 风格的淡入淡出动画
    states [
        hover when touch-area.has-hover && enabled: {
            background.background: LightColors.button-hover;
            background.opacity: 1.0;
            icon-image.opacity: 0.8;
        }
        pressed when touch-area.pressed && enabled: {
            background.background: LightColors.button-active;
            background.opacity: 1.0;
            icon-image.opacity: 0.6;
        }
    ]

    background := Rectangle {
        width: 100%;
        height: 100%;
        border-radius: parent.width / 2;  // 完美圆形
        background: transparent;
        opacity: 0.0;

        // 流畅的动画过渡
        animate background {
            duration: 150ms;
            easing: ease-in-out;
        }

        animate opacity {
            duration: 150ms;
            easing: ease-in-out;
        }
    }

    icon-image := Image {
        source: icon;
        width: icon-size;
        height: icon-size;
        colorize: enabled ? LightColors.text-secondary : LightColors.text-tertiary;
        opacity: 1.0;

        animate opacity {
            duration: 150ms;
            easing: ease-in-out;
        }

        animate colorize {
            duration: 150ms;
            easing: ease-in-out;
        }
    }

    touch-area := TouchArea {
        mouse-cursor: enabled ? pointer : default;
        clicked => {
            if (enabled) {
                root.clicked();
            }
        }
    }
}